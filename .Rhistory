correlations
corrplot(as.matrix(correlations))
wa_pairs <- wa.cor[, c(1, 3:4, 6:11, 13)]
ggpairs(subset(wa_pairs, select = -contbr_gender))
ggplot(wa, aes(contb_receipt_amt)) +
geom_freqpoly(aes(color = party)) +
scale_x_log10()
ggplot(subset(wa, !is.na(contbr_gender)),
aes(contb_receipt_amt, ..count../sum(..count..))) +
geom_freqpoly(aes(color = contbr_gender)) +
scale_x_log10()
ggplot(subset(wa, !is.na(election_tp)),
aes(contb_receipt_amt)) +
geom_freqpoly(aes(color = election_tp)) +
scale_x_log10()
# can't figure out what the red line represent, since na were already filtered.
plot_point <- function(x, y) {
ggplot(wa, aes_string(x, y)) +
geom_jitter(alpha = 0.02) +
geom_smooth(method = 'lm', color = "red") +
geom_smooth(color = "blue")
}
p1 <- plot_point("total_population", "median_age")
p2 <- plot_point("percent_white", "percent_black")
p3 <- plot_point("percent_asian", "per_capita_income")
p4 <- plot_point("percent_hispanic", "median_rent")
grid.arrange(p1, p2, p3, p4)
wa.amt_by_party <- wa %>%
group_by(party) %>%
summarise(amt_sum = sum(contb_receipt_amt),
amt_median = median(contb_receipt_amt),
amt_mean = mean(contb_receipt_amt),
n = n())
p1 <- ggplot(wa.amt_by_party, aes(party, amt_sum)) +
geom_bar(stat = 'identity', aes(fill = party)) +
scale_fill_manual("legend",
values = c("blue", "green", "red"))
p2 <- ggplot(wa.amt_by_party, aes(party)) +
geom_bar(aes(y = amt_mean, fill = party), stat = 'identity') +
scale_fill_manual("legend",
values = c("blue", "green", "red"))
grid.arrange(p1, p2, ncol = 1)
wa.amt_by_contbr_gender <- subset(wa, !is.na(contbr_gender)) %>%
group_by(contbr_gender) %>%
summarise(amt_sum = sum(contb_receipt_amt),
amt_median = median(contb_receipt_amt),
amt_mean = mean(contb_receipt_amt),
n = n())
p1 <- ggplot(wa.amt_by_contbr_gender, aes(contbr_gender, amt_sum)) +
geom_bar(stat = 'identity', aes(fill = contbr_gender)) +
scale_fill_manual("legend",
values = c("red", "blue"))
p2 <- ggplot(wa.amt_by_contbr_gender, aes(contbr_gender)) +
geom_bar(aes(y = amt_mean, fill = contbr_gender), stat = 'identity') +
scale_fill_manual("legend",
values = c("red", "blue"))
grid.arrange(p1, p2, ncol = 1)
wa.amt_by_income <- wa %>%
group_by(per_capita_income) %>%
summarise(amt_sum = sum(contb_receipt_amt),
amt_median = median(contb_receipt_amt),
amt_mean = mean(contb_receipt_amt),
n = n()) %>%
arrange(per_capita_income)
p1 <- ggplot(wa.amt_by_income, aes(round(per_capita_income / 1000) * 1000, amt_sum)) +
geom_line()
p2 <- ggplot(wa.amt_by_income, aes(round(per_capita_income / 1000) * 1000)) +
geom_line(aes(y = amt_median, color = 'blue')) +
geom_line(aes(y = amt_mean, color = 'red')) +
scale_x_continuous(breaks = seq(0, 100000, 25000)) +
scale_color_manual(labels = c("median amount", "mean amount"), values = c("blue", "red")) +
theme(legend.position = 'bottom')
grid.arrange(p1, p2, ncol = 1)
wa.amt_by_age<- wa %>%
group_by(median_age) %>%
summarise(amt_sum = sum(contb_receipt_amt),
amt_median = median(contb_receipt_amt),
amt_mean = mean(contb_receipt_amt),
n = n()) %>%
arrange(median_age)
p1 <- ggplot(wa.amt_by_age, aes(median_age, amt_sum)) +
scale_x_continuous(breaks = seq(20, 60, 10)) +
geom_line()
p2 <- ggplot(wa.amt_by_age, aes(median_age)) +
scale_x_continuous(breaks = seq(20, 60, 10)) +
geom_line(aes(y = amt_median, color = 'blue')) +
geom_line(aes(y = amt_mean, color = 'red')) +
scale_color_manual(labels = c("median amount", "mean amount"), values = c("blue", "red")) +
theme(legend.position = 'bottom')
grid.arrange(p1, p2, ncol = 1)
wa.amt_by_percent_white <- wa %>%
group_by(percent_white) %>%
summarise(amt_sum = sum(contb_receipt_amt),
amt_median = median(contb_receipt_amt),
amt_mean = mean(contb_receipt_amt),
n = n()) %>%
arrange(percent_white)
wa.amt_by_percent_black <- wa %>%
group_by(percent_black) %>%
summarise(amt_sum = sum(contb_receipt_amt),
amt_median = median(contb_receipt_amt),
amt_mean = mean(contb_receipt_amt),
n = n()) %>%
arrange(percent_black)
wa.amt_by_percent_asian <- wa %>%
group_by(percent_asian) %>%
summarise(amt_sum = sum(contb_receipt_amt),
amt_median = median(contb_receipt_amt),
amt_mean = mean(contb_receipt_amt),
n = n()) %>%
arrange(percent_asian)
wa.amt_by_percent_hispanic <- wa %>%
group_by(percent_hispanic) %>%
summarise(amt_sum = sum(contb_receipt_amt),
amt_median = median(contb_receipt_amt),
amt_mean = mean(contb_receipt_amt),
n = n()) %>%
arrange(percent_hispanic)
p1 <- ggplot() +
geom_line(data = wa.amt_by_percent_white, aes(percent_white, amt_sum, color = 'blue')) +
geom_line(data = wa.amt_by_percent_black, aes(percent_black, amt_sum, color = 'black')) +
geom_line(data = wa.amt_by_percent_asian, aes(percent_asian, amt_sum, color = 'orange')) +
geom_line(data = wa.amt_by_percent_hispanic, aes(percent_hispanic, amt_sum, color = 'red')) +
scale_x_continuous(breaks = seq(0, 100, 10)) +
scale_colour_manual(labels = c("percent_white", "percent_black",
"percent_asian", "percent_hispanic"),
values=c("blue","black","orange", "red"))
p2 <- ggplot() +
geom_line(data = wa.amt_by_percent_white, aes(percent_white, amt_mean, color = 'blue')) +
geom_line(data = wa.amt_by_percent_black, aes(percent_black, amt_mean, color = 'black')) +
geom_line(data = wa.amt_by_percent_asian, aes(percent_asian, amt_mean, color = 'orange')) +
geom_line(data = wa.amt_by_percent_hispanic, aes(percent_hispanic, amt_mean, color = 'red')) +
scale_x_continuous(breaks = seq(0, 100, 10)) +
scale_colour_manual(labels = c("percent_white", "percent_black",
"percent_asian", "percent_hispanic"),
values = c("blue","black","orange", "red"))
grid.arrange(p1, p2, ncol = 1)
elec_date <- as.Date('2016-11-8')
republican_nomination_date <- as.Date('2016-7-21')
democratic_nomination_date <- as.Date('2016-7-28')
republican_caucuses_date <- as.Date('2016-2-20')
democratic_caucuses_date <- as.Date('2016-3-26')
ggplot(wa, aes(contb_receipt_dt)) +
scale_x_date(limits = as.Date(c('2015-03-01','2016-11-8')),
date_breaks = "1 month", date_labels =  "%b %Y") +
geom_freqpoly(binwidth = 7) +
geom_vline(xintercept=elec_date, color="purple") +
geom_vline(xintercept=republican_nomination_date, color="red") +
geom_vline(xintercept=democratic_nomination_date, color="blue") +
geom_vline(xintercept=republican_caucuses_date, color="red") +
geom_vline(xintercept=democratic_caucuses_date, color="blue") +
theme(axis.text.x=element_text(angle=60, hjust=1))
ggplot(wa, aes(cand_nm, log(contb_receipt_amt + 1))) +
geom_boxplot(aes(color = party)) +
scale_colour_manual(values = c("democrat" = "blue", "republican" = "red",
"others" = "green")) +
theme(axis.text.x=element_text(angle=60, hjust=1), legend.position = "bottom")
ggplot(wa, aes(cand_nm, log(contb_receipt_amt + 1))) +
geom_boxplot(aes(color = cand_gender)) +
theme(axis.text.x=element_text(angle=60, hjust=1), legend.position = "bottom")
ggplot(subset(wa, !is.na(contbr_gender)),
aes(cand_nm, log(contb_receipt_amt + 1))) +
geom_boxplot(aes(color = contbr_gender)) +
theme(axis.text.x=element_text(angle=60, hjust=1), legend.position = "bottom")
# color = ifelse(wa$cand_gender == 'male', 'blue', 'red')))
# color the x axis text according to candidate gender
ggplot(wa %>%
subset(party != "others" & median_age >= 18) %>%
subset(!is.na(median_age) & !is.na(contbr_gender) ) %>%
mutate(age_cut = cut(median_age, breaks = c(18, 25, 35, 45, 60, 80),
include.lowest = T, include.highest = T)),
aes(cand_nm, contb_receipt_amt)) +
geom_boxplot(aes(color = contbr_gender),
alpha = 0.05, cex = 0.1) +
scale_color_manual(label = c("male", "female"),
values = c("blue", "red")) +
facet_wrap(~age_cut, ncol = 1) +
theme(axis.text.x=element_text(angle=60, hjust=1), legend.position = 'bottom')
wa.amt_democrat_by_zip <- wa[(wa$party == "democrat"), ] %>%
group_by(contbr_zip) %>%
summarise(amt_sum = sum(contb_receipt_amt),
amt_median = median(contb_receipt_amt),
amt_mean = mean(contb_receipt_amt),
n = n()) %>%
arrange(contbr_zip)
wa.amt_republican_by_zip <- wa[(wa$party == "republican"), ] %>%
group_by(contbr_zip) %>%
summarise(amt_sum = sum(contb_receipt_amt),
amt_median = median(contb_receipt_amt),
amt_mean = mean(contb_receipt_amt),
n = n()) %>%
arrange(contbr_zip)
wa.amt_by_zip_party <- data.frame(wa.amt_democrat_by_zip$contbr_zip,
wa.amt_democrat_by_zip$amt_sum,
wa.amt_democrat_by_zip$n)
wa.amt_by_zip_party <- merge(wa.amt_by_zip_party, wa.amt_republican_by_zip[, c(1:2, 5)],
by.x = 'wa.amt_democrat_by_zip.contbr_zip',
by.y = 'contbr_zip',
all = T)
colnames(wa.amt_by_zip_party) <- c("zipcode", "amt_democrat_sum", "amt_democrat_n",
"amt_republican_sum", "amt_republican_n")
wa.amt_trump <- wa[(wa$cand_nm == "Trump, Donald J."), ] %>%
group_by(contbr_zip) %>%
summarise(amt_sum = sum(contb_receipt_amt),
amt_median = median(contb_receipt_amt),
amt_mean = mean(contb_receipt_amt),
n = n()) %>%
arrange(contbr_zip)
wa.amt_hillary <- wa[(wa$cand_nm == "Clinton, Hillary Rodham"), ] %>%
group_by(contbr_zip) %>%
summarise(amt_sum = sum(contb_receipt_amt),
amt_median = median(contb_receipt_amt),
amt_mean = mean(contb_receipt_amt),
n = n()) %>%
arrange(contbr_zip)
wa.amt_trump_hillary <- data.frame(wa.amt_trump$contbr_zip,
wa.amt_trump$amt_sum,
wa.amt_trump$n)
wa.amt_trump_hillary <- merge(wa.amt_trump_hillary, wa.amt_hillary[, c(1:2, 5)],
by.x = "wa.amt_trump.contbr_zip",
by.y = "contbr_zip",
all = T)
colnames(wa.amt_trump_hillary) <- c("zipcode", "trump_sum", "trump_n",
"hillary_sum", "hillary_n")
wa.amt_occupation_trump <- wa[(wa$cand_nm == "Trump, Donald J."), ] %>%
group_by(contbr_occupation) %>%
summarise(amt_sum = sum(contb_receipt_amt),
amt_median = median(contb_receipt_amt),
amt_mean = mean(contb_receipt_amt),
n = n()) %>%
arrange(desc(n))
wa.amt_occupation_hillary <- wa[(wa$cand_nm == "Clinton, Hillary Rodham"), ] %>%
group_by(contbr_occupation) %>%
summarise(amt_sum = sum(contb_receipt_amt),
amt_median = median(contb_receipt_amt),
amt_mean = mean(contb_receipt_amt),
n = n()) %>%
arrange(desc(n))
wa.hillary_trump <- subset(wa, cand_nm == "Clinton, Hillary Rodham" |
cand_nm == "Trump, Donald J.",
select = -c(election_tp, cand_nm, median_rent,
time, contb_receipt_dt, contbr_first_nm))
plot_trump_hillary <- function(v) {
ggplot(data = wa.hillary_trump, aes_string(v, "contb_receipt_amt")) +
geom_point(aes(color = wa.hillary_trump$cand_first_nm), alpha = 0.1, cex = 0.1) +
labs(color='Candidate')
}
p1 <- plot_trump_hillary("per_capita_income")
p2 <- plot_trump_hillary("total_population")
p3 <- plot_trump_hillary("median_age")
p4 <- plot_trump_hillary("percent_white")
p5 <- plot_trump_hillary("percent_black")
p6 <- plot_trump_hillary("percent_asian")
p7 <- plot_trump_hillary("percent_hispanic")
grid.arrange(p1, p2, p3, p4, p5, p6, p7, ncol = 2)
m1 <- lm(data = wa, contb_receipt_amt ~ per_capita_income)
m2 <- update(m1, ~ . + contbr_gender)
m3 <- update(m2, ~ . + party)
m4 <- update(m3, ~ . + median_age)
m5 <- update(m4, ~ . + percent_white)
mtable(m1, m2, m3, m4, m5, sdigits = 3)
hillary_occupation_amt <- wa.amt_occupation_hillary %>%
subset(contbr_occupation != "RETIRED" & contbr_occupation != "INFORMATION REQUESTED") %>%
head(20)
trump_occupation_amt <- wa.amt_occupation_trump %>%
subset(contbr_occupation != "RETIRED" & contbr_occupation != "INFORMATION REQUESTED") %>%
head(20)
p1 <- ggplot(hillary_occupation_amt, aes(reorder(contbr_occupation, n), n)) +
geom_bar(stat = "identity", aes(fill = contbr_occupation)) +
coord_flip()
p2 <- ggplot(trump_occupation_amt, aes(reorder(contbr_occupation, n), n)) +
geom_bar(stat = "identity", aes(fill = contbr_occupation)) +
coord_flip()
grid.arrange(p1, p2)
elec_date <- as.Date('2016-11-8')
republican_nomination_date <- as.Date('2016-7-21')
democratic_nomination_date <- as.Date('2016-7-28')
republican_caucuses_date <- as.Date('2016-2-20')
democratic_caucuses_date <- as.Date('2016-3-26')
hillary_email <- as.Date('2016-7-22')
ggplot(wa %>%
subset(cand_nm == "Clinton, Hillary Rodham" | cand_nm == "Trump, Donald J.") %>%
mutate(amt_cut = cut(contb_receipt_amt, breaks = c(0, 200, 500, 1000, 1500, 2700),
include.lowest = T, include.highest = T)),
aes(contb_receipt_dt)) +
scale_x_date(limits = as.Date(c('2015-03-01','2016-11-8')),
date_breaks = "1 month", date_labels =  "%b %Y") +
geom_freqpoly(aes(color = cand_nm), binwidth = 7) +
geom_vline(xintercept=elec_date, color="purple") +
geom_vline(xintercept=republican_nomination_date, color="red") +
geom_vline(xintercept=democratic_nomination_date, color="blue") +
geom_vline(xintercept=republican_caucuses_date, color="red") +
geom_vline(xintercept=democratic_caucuses_date, color="blue") +
geom_vline(xintercept=hillary_email, color="gold") +
facet_wrap(~amt_cut, ncol = 1, scales = "free_y") +
theme(axis.text.x=element_text(angle=60, hjust=1))
elec_date <- as.Date('2016-11-8')
republican_nomination_date <- as.Date('2016-7-21')
democratic_nomination_date <- as.Date('2016-7-28')
republican_caucuses_date <- as.Date('2016-2-20')
democratic_caucuses_date <- as.Date('2016-3-26')
hillary_email <- as.Date('2016-7-22')
income_quant <- quantile(wa$per_capita_income, probs = c(0, .05, .2, .35, .5, .65, .8, .95, 1))
ggplot(wa %>%
subset(!is.na(per_capita_income)) %>%
subset(cand_nm == "Clinton, Hillary Rodham" | cand_nm == "Trump, Donald J.") %>%
mutate(income_cut = cut(per_capita_income,
breaks = quantile(per_capita_income,
probs = c(0, .2, .35, .5, .65, .8, 1)),
include.lowest = T, include.highest = T)),
aes(contb_receipt_dt)) +
scale_x_date(limits = as.Date(c('2015-03-01','2016-11-8')),
date_breaks = "1 month", date_labels =  "%b %Y") +
geom_freqpoly(aes(color = cand_nm), binwidth = 7) +
geom_vline(xintercept=elec_date, color="purple") +
geom_vline(xintercept=republican_nomination_date, color="red") +
geom_vline(xintercept=democratic_nomination_date, color="blue") +
geom_vline(xintercept=republican_caucuses_date, color="red") +
geom_vline(xintercept=democratic_caucuses_date, color="blue") +
geom_vline(xintercept=hillary_email, color="gold") +
facet_wrap(~income_cut, ncol = 1, scales = "free_y") +
theme(axis.text.x=element_text(angle=60, hjust=1))
elec_date <- as.Date('2016-11-8')
republican_nomination_date <- as.Date('2016-7-21')
democratic_nomination_date <- as.Date('2016-7-28')
republican_caucuses_date <- as.Date('2016-2-20')
democratic_caucuses_date <- as.Date('2016-3-26')
hillary_email <- as.Date('2016-7-22')
ggplot(wa %>%
subset(!is.na(per_capita_income)) %>%
subset(cand_nm == "Clinton, Hillary Rodham" | cand_nm == "Trump, Donald J.") %>%
mutate(income_cut = cut(per_capita_income,
breaks = quantile(per_capita_income,
probs = c(0, .2, .35, .5, .65, .8, 1)),
include.lowest = T, include.highest = T)),
aes(contb_receipt_dt)) +
scale_x_date(limits = as.Date(c('2015-03-01','2016-11-8')),
date_breaks = "1 month", date_labels =  "%b %Y") +
geom_freqpoly(aes(color = cand_nm), binwidth = 7) +
geom_vline(xintercept=elec_date, color="purple") +
geom_vline(xintercept=republican_nomination_date, color="red") +
geom_vline(xintercept=democratic_nomination_date, color="blue") +
geom_vline(xintercept=republican_caucuses_date, color="red") +
geom_vline(xintercept=democratic_caucuses_date, color="blue") +
geom_vline(xintercept=hillary_email, color="gold") +
facet_wrap(~income_cut, ncol = 1, scales = "free_y") +
theme(axis.text.x=element_text(angle=60, hjust=1))
mapdata.wa <- zip.map %>%
filter(region %in% wa$contbr_zip) %>%
arrange(order)
ggplot() +
geom_map(data = mapdata.wa, map = mapdata.wa,
aes(map_id = region, x = long, y = lat, group = group),
fill = "white", color = "lightgrey") +
geom_map(data = wa.amt_by_zip_party, map = mapdata.wa,
aes(map_id = zipcode,
fill = ifelse(amt_democrat_sum < amt_republican_sum,
'red', 'blue')),
color = "lightgray") +
coord_map(projection = "mercator") +
geom_point(data = city.wa,
aes(x = lng, y = lat),
size = log10(city.wa$population),
color = 'gold', alpha = 0.4) +
scale_fill_manual(label = c('republican', 'democratic'),
values = c("red", "blue")) +
theme_map() +
theme(legend.position = "bottom")
ggplot() +
geom_map(data = mapdata.wa, map = mapdata.wa,
aes(map_id = region, x = long, y = lat, group = group),
fill = "white", color = "lightgrey") +
geom_map(data = wa.amt_by_zip_party, map = mapdata.wa,
aes(map_id = zipcode,
fill = ifelse(amt_democrat_n < amt_republican_n,
'red', 'blue')),
color = "lightgray") +
coord_map(projection = "mercator") +
geom_point(data = city.wa,
aes(x = lng, y = lat),
size = log10(city.wa$population),
color = 'gold', alpha = 0.4) +
scale_fill_manual(label = c('republican', 'democratic'),
values = c("red", "blue")) +
theme_map() +
theme(legend.position = "bottom")
ggplot() +
geom_map(data = mapdata.wa, map = mapdata.wa,
aes(map_id = region, x = long, y = lat, group = group),
fill = "white", color = "lightgrey") +
geom_map(data = wa.amt_trump_hillary, map = mapdata.wa,
aes(map_id = zipcode,
fill = ifelse(trump_n > hillary_n,
'red', 'blue')),
color = "lightgray") +
coord_map(projection = "mercator") +
geom_point(data = city.wa,
aes(x = lng, y = lat),
size = log10(city.wa$population),
color = 'gold', alpha = 0.2) +
scale_fill_manual(label = c('Trump', 'Hillary'),
values = c("red", "blue")) +
theme_map() +
theme(legend.position = "bottom")
ggplot() +
geom_map(data = mapdata.wa, map = mapdata.wa,
aes(map_id = region, x = long, y = lat, group = group),
fill = "white", color = "lightgrey") +
geom_map(data = wa.amt_trump_hillary, map = mapdata.wa,
aes(map_id = zipcode,
fill = ifelse(trump_sum > hillary_sum,
'red', 'blue')),
color = "lightgray") +
coord_map(projection = "mercator") +
geom_point(data = city.wa,
aes(x = lng, y = lat),
size = log10(city.wa$population),
color = 'gold', alpha = 0.4) +
scale_fill_manual(label = c('Trump', 'Hillary'),
values = c("red", "blue")) +
theme_map() +
theme(legend.position = "bottom")
m5
cand_color = rep("blue", 21)
cand_color[c(4, 6, 18)] <- "red"
ggplot(wa %>%
subset(party != "others" & median_age >= 18) %>%
subset(!is.na(median_age) & !is.na(contbr_gender) ) %>%
mutate(age_cut = cut(median_age, breaks = c(18, 25, 35, 45, 60, 80),
include.lowest = T, include.highest = T)),
aes(cand_nm, contb_receipt_amt)) +
geom_boxplot(aes(color = contbr_gender),
alpha = 0.05, cex = 0.1) +
scale_y_log10() +
scale_color_manual(label = c("male", "female"),
values = c("blue", "red")) +
facet_wrap(~age_cut, ncol = 1) +
labs(title = "Donator's age and gender structure for Candidate",
x = "Candidate", y = "Contribution(log)") +
theme(axis.text.x=element_text(angle=60, hjust=1,
color = cand_color),
legend.position = 'bottom')
elec_date <- as.Date('2016-11-8')
republican_nomination_date <- as.Date('2016-7-21')
democratic_nomination_date <- as.Date('2016-7-28')
republican_caucuses_date <- as.Date('2016-2-20')
democratic_caucuses_date <- as.Date('2016-3-26')
hillary_email <- as.Date('2016-7-22')
ggplot(wa %>%
subset(cand_nm == "Clinton, Hillary Rodham" | cand_nm == "Trump, Donald J.") %>%
mutate(amt_cut = cut(contb_receipt_amt, breaks = c(0, 200, 500, 1000, 1500, 2700),
include.lowest = T, include.highest = T)),
aes(contb_receipt_dt)) +
scale_x_date(limits = as.Date(c('2015-03-01','2016-11-8')),
date_breaks = "1 month", date_labels =  "%b %Y") +
geom_freqpoly(aes(color = cand_nm), binwidth = 7) +
geom_vline(xintercept=elec_date, color="purple") +
geom_vline(xintercept=republican_nomination_date, color="red") +
geom_vline(xintercept=democratic_nomination_date, color="blue") +
geom_vline(xintercept=republican_caucuses_date, color="red") +
geom_vline(xintercept=democratic_caucuses_date, color="blue") +
geom_vline(xintercept=hillary_email, color="gold") +
facet_wrap(~amt_cut, ncol = 1, scales = "free_y") +
labs(title = "Contribution Trend", x = "Date", y = "Count") +
theme(axis.text.x=element_text(angle=60, hjust=1))
ggplot() +
geom_map(data = mapdata.wa, map = mapdata.wa,
aes(map_id = region, x = long, y = lat, group = group),
fill = "white", color = "lightgrey") +
geom_map(data = wa.amt_trump_hillary, map = mapdata.wa,
aes(map_id = zipcode,
fill = ifelse(trump_sum > hillary_sum,
'red', 'blue')),
color = "lightgray") +
coord_map(projection = "mercator") +
geom_point(data = city.wa,
aes(x = lng, y = lat),
size = log10(city.wa$population),
color = 'gold', alpha = 0.4) +
scale_fill_manual(label = c('Trump', 'Hillary'),
values = c("red", "blue")) +
theme_map() +
labs(title = "Contribution Map", fill = "Candidate") +
theme(legend.position = "bottom")
hillary_occupation_amt <- wa.amt_occupation_hillary %>%
subset(contbr_occupation != "RETIRED" & contbr_occupation != "INFORMATION REQUESTED") %>%
head(20)
trump_occupation_amt <- wa.amt_occupation_trump %>%
subset(contbr_occupation != "RETIRED" & contbr_occupation != "INFORMATION REQUESTED") %>%
head(20)
p1 <- ggplot(hillary_occupation_amt, aes(reorder(contbr_occupation, n), n)) +
geom_bar(stat = "identity", aes(fill = contbr_occupation)) +
coord_flip() +
labs(title = "Occupation of Hillary's donator ", x = "Occupation", y = "count",
fill ="Occupation")
p2 <- ggplot(trump_occupation_amt, aes(reorder(contbr_occupation, n), n)) +
geom_bar(stat = "identity", aes(fill = contbr_occupation)) +
coord_flip() +
labs(title = "Occupation of Trump's donator ", x = "Occupation", y = "count",
fill = "Occupation")
grid.arrange(p1, p2)
ggplot(subset(city_freq, Freq > 2000), aes(Var1, Freq)) +
geom_bar(stat = 'identity') +
coord_flip() +
theme(axis.text.y = element_text(hjust = 0, size = 10),
plot.margin = margin(0.1, 0.1, 0.1, 0.1))
```{r echo=FALSE}
ggplot(subset(city_freq, Freq > 2000), aes(Var1, Freq)) +
geom_bar(stat = 'identity') +
coord_flip() +
theme(axis.text.y = element_text(hjust = 0, size = 10),
plot.margin = margin(0.1, 0.1, 0.1, 0.1))
